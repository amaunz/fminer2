<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>liblast: Last Class Reference</title>
<link href="liblast.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Last Class Reference</h1><!-- doxytag: class="Last" --><code>#include &lt;<a class="el" href="last_8h-source.html">last.h</a>&gt;</code>
<p>

<p>
<a href="classLast-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Inits</div></td></tr>
<tr><td colspan="2"><div class="groupText">Initializer functions. <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#0c3fef1f249450ef678cdd46bd88e3a7">Last</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor for standard settings: 95% significance level, minimum frequency 2, type trees, dynamic upper bound, BBRC.  <a href="#0c3fef1f249450ef678cdd46bd88e3a7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#d3a25f17998fc8f8c7cb79ec80852b51">~Last</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#372de693ad40b3f42839c8ec6ac845f4">Reset</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Use this to clear the database before feeding new compounds and activities.  <a href="#372de693ad40b3f42839c8ec6ac845f4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#9f4ebfcbb62fb16b57c5bcdfaacd451f">Defaults</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Use this to set default parameters as in default constructor.  <a href="#9f4ebfcbb62fb16b57c5bcdfaacd451f"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Getters</div></td></tr>
<tr><td colspan="2"><div class="groupText">Getter functions. <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#6b73a9fcdd27d073f4ba6686c9cca02f">GetMinfreq</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get minimum frequency.  <a href="#6b73a9fcdd27d073f4ba6686c9cca02f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#00c83761de7dca2e16d741650b41f1ef">GetType</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get type.  <a href="#00c83761de7dca2e16d741650b41f1ef"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#4dd6282e6926b0e7a926036127042030">GetBackbone</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get whether BBRC representatives should be mined.  <a href="#4dd6282e6926b0e7a926036127042030"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#b0cbbc3a50704734e46986234dbc68ce">GetDynamicUpperBound</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get whether dynamic upper bound pruning is used.  <a href="#b0cbbc3a50704734e46986234dbc68ce"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#e89056d89e3847cce0172baea6a37b26">GetPruning</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get whether statistical metric pruning should be used.  <a href="#e89056d89e3847cce0172baea6a37b26"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#91c37ee435171e92c4efe49e084d6130">GetConsoleOut</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get whether output should be directed to the console.  <a href="#91c37ee435171e92c4efe49e084d6130"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#8c5138a564797432427b6667dd2976b3">GetAromatic</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get whether aromatic rings should be perceived instead of Kekule notation.  <a href="#8c5138a564797432427b6667dd2976b3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#43b57f5108e2a25ae8b08ab91179dfb5">GetRefineSingles</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get whether fragments with frequency 1 should be refined.  <a href="#43b57f5108e2a25ae8b08ab91179dfb5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#854663daf425c444db86d80cc862ba9c">GetDoOutput</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get whether output is enabled.  <a href="#854663daf425c444db86d80cc862ba9c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#84f3001cb532d71e4edce28fc0f83ec2">GetBbrcSep</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get whether BBRCs should be separated in the output.  <a href="#84f3001cb532d71e4edce28fc0f83ec2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#f23472dda234c80fdc244494cd4f09cc">GetChisqActive</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get whether chi-square filter is active.  <a href="#f23472dda234c80fdc244494cd4f09cc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#5b719d86b406c885f898ea332ec8deaf">GetChisqSig</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get significance threshold.  <a href="#5b719d86b406c885f898ea332ec8deaf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#8471ab39593e52b542e9284a12517f4c">GetRegression</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dummy method for regression (only used for bbrcs).  <a href="#8471ab39593e52b542e9284a12517f4c"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Setters</div></td></tr>
<tr><td colspan="2"><div class="groupText">Setter functions. <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#1943edc900a48af0fc9498f5d0579d80">SetMinfreq</a> (int val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set minimum frequency (&gt;=1 here).  <a href="#1943edc900a48af0fc9498f5d0579d80"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#bc2a46f77095216632a268a9417f1174">SetType</a> (int val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set type 1 (paths) or 2 (trees) here.  <a href="#bc2a46f77095216632a268a9417f1174"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#7a001c8c0f5014435e1a28ba57a5d5f2">SetBackbone</a> (bool val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pass 'false' here to switch off mining for BBRC representatives.  <a href="#7a001c8c0f5014435e1a28ba57a5d5f2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#273df5b815f6f9318aa65db134283b0e">SetDynamicUpperBound</a> (bool val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pass 'false' here to disable dynamic upper bound pruning (e.g. for performance measures).  <a href="#273df5b815f6f9318aa65db134283b0e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#3eef7a8547f2a4940fd0f4b7d1b70861">SetPruning</a> (bool val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pass 'false' here to disable statistical metrical pruning completely.  <a href="#3eef7a8547f2a4940fd0f4b7d1b70861"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#3dfd23b477755e3b2156185b2f73878b">SetConsoleOut</a> (bool val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pass 'true' here to disable usage of result vector and directly print each fragment to the console (saves memory).  <a href="#3dfd23b477755e3b2156185b2f73878b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#b5195d37511301667fcc1a341f0888bf">SetAromatic</a> (bool val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pass 'true' here to enable aromatic rings and use Kekule notation.  <a href="#b5195d37511301667fcc1a341f0888bf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#799653965569b70a7dd88ef16d56f569">SetRefineSingles</a> (bool val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pass 'true' here to enable refinement of fragments with frequency 1.  <a href="#799653965569b70a7dd88ef16d56f569"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#5ba23af2c3f5f549da20c6def6e0c554">SetDoOutput</a> (bool val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pass 'false' here to disable output.  <a href="#5ba23af2c3f5f549da20c6def6e0c554"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#c569ce6ce6150f0efc5ac9e13293b517">SetBbrcSep</a> (bool val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set this to 'true' to enable BBRC separators in output.  <a href="#c569ce6ce6150f0efc5ac9e13293b517"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#3040636e6d4456e59fa925ddad8d4eb4">SetChisqActive</a> (bool val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set this to 'true' to enable chi-square filter.  <a href="#3040636e6d4456e59fa925ddad8d4eb4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#2ffe9fadf7a96e7d3f83cbd977004278">SetChisqSig</a> (float _chisq_val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set significance threshold here (between 0 and 1).  <a href="#2ffe9fadf7a96e7d3f83cbd977004278"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#7b8900193deba5c64f10fe35d8bc5875">SetRegression</a> (bool val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dummy method for regression (only used for bbrcs).  <a href="#7b8900193deba5c64f10fe35d8bc5875"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Others</div></td></tr>
<tr><td colspan="2"><div class="groupText">Other functions. <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">vector&lt; string &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#ca859309dfdec16d1fe7bbca9a31910a">MineRoot</a> (unsigned int j)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mine fragments rooted at the j-th root node (element type).  <a href="#ca859309dfdec16d1fe7bbca9a31910a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#f877482dbaf9aa27fbe9524479758c9c">ReadGsp</a> (FILE *gsp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read in a gSpan file.  <a href="#f877482dbaf9aa27fbe9524479758c9c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#7ae3274987947421c41022918f48378d">AddCompound</a> (string smiles, unsigned int comp_id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a compound to the database.  <a href="#7ae3274987947421c41022918f48378d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#864483449b0171b7e7c33851471c9087">AddActivity</a> (float act, unsigned int comp_id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add an activity to the database.  <a href="#864483449b0171b7e7c33851471c9087"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#bc7291463c89c905f4371f3d9ba12f47">GetNoRootNodes</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get number of root nodes (different element types).  <a href="#bc7291463c89c905f4371f3d9ba12f47"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLast.html#9b74deeffd380f1269c906f4178a8ab0">GetNoCompounds</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get number of compounds in the database.  <a href="#9b74deeffd380f1269c906f4178a8ab0"></a><br></td></tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="0c3fef1f249450ef678cdd46bd88e3a7"></a><!-- doxytag: member="Last::Last" ref="0c3fef1f249450ef678cdd46bd88e3a7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLast.html">Last</a>           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor for standard settings: 95% significance level, minimum frequency 2, type trees, dynamic upper bound, BBRC. 
<p>

<p>References <a class="el" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>, <a class="el" href="last_8cpp-source.html#l00120">Defaults()</a>, <a class="el" href="namespacefm.html#b121ac08f2cdaf32be0af36a5ae79755">fm::gsp_out</a>, and <a class="el" href="last_8cpp-source.html#l00095">Reset()</a>.</p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00319">create0()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00028"></a>00028            : init_mining_done(<span class="keyword">false</span>) {
<a name="l00029"></a>00029   <span class="keywordflow">if</span> (!fm::instance_present) {
<a name="l00030"></a>00030       fm::database = NULL; fm::statistics = NULL; <a class="code" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a> = NULL; fm::result = NULL;
<a name="l00031"></a>00031       <a class="code" href="classLast.html#372de693ad40b3f42839c8ec6ac845f4" title="Use this to clear the database before feeding new compounds and activities.">Reset</a>();
<a name="l00032"></a>00032       <a class="code" href="classLast.html#9f4ebfcbb62fb16b57c5bcdfaacd451f" title="Use this to set default parameters as in default constructor.">Defaults</a>();
<a name="l00033"></a>00033       fm::instance_present=<span class="keyword">true</span>;
<a name="l00034"></a>00034       <a class="code" href="namespacefm.html#b121ac08f2cdaf32be0af36a5ae79755">fm::gsp_out</a> = <span class="keyword">false</span>; 
<a name="l00035"></a>00035   }
<a name="l00036"></a>00036   <span class="keywordflow">else</span> {
<a name="l00037"></a>00037     cerr &lt;&lt; <span class="stringliteral">"Error! Cannot create more than 1 instance."</span> &lt;&lt; endl; 
<a name="l00038"></a>00038     exit(1);
<a name="l00039"></a>00039   }
<a name="l00040"></a>00040 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d3a25f17998fc8f8c7cb79ec80852b51"></a><!-- doxytag: member="Last::~Last" ref="d3a25f17998fc8f8c7cb79ec80852b51" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classLast.html">Last</a>           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>References <a class="el" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00078"></a>00078             {
<a name="l00079"></a>00079     <span class="keywordflow">if</span> (fm::instance_present) {
<a name="l00080"></a>00080         <span class="keyword">delete</span> fm::database;
<a name="l00081"></a>00081         <span class="keyword">delete</span> fm::statistics; 
<a name="l00082"></a>00082         <span class="keyword">delete</span> <a class="code" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>; 
<a name="l00083"></a>00083         <span class="keyword">delete</span> fm::graphstate;
<a name="l00084"></a>00084         <span class="keyword">delete</span> fm::closelegoccurrences;
<a name="l00085"></a>00085         <span class="keyword">delete</span> fm::legoccurrences;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087         fm::candidatelegsoccurrences.clear();
<a name="l00088"></a>00088         fm::candidatecloselegsoccs.clear();
<a name="l00089"></a>00089         fm::candidatecloselegsoccsused.clear();
<a name="l00090"></a>00090 
<a name="l00091"></a>00091         fm::instance_present=<span class="keyword">false</span>;
<a name="l00092"></a>00092     }
<a name="l00093"></a>00093 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="372de693ad40b3f42839c8ec6ac845f4"></a><!-- doxytag: member="Last::Reset" ref="372de693ad40b3f42839c8ec6ac845f4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Reset           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Use this to clear the database before feeding new compounds and activities. 
<p>

<p>References <a class="el" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>.</p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00028">Last()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00095"></a>00095                  { 
<a name="l00096"></a>00096     <span class="keywordflow">if</span> (fm::instance_present) {
<a name="l00097"></a>00097         <span class="keyword">delete</span> fm::database;
<a name="l00098"></a>00098         <span class="keyword">delete</span> fm::statistics;
<a name="l00099"></a>00099         <span class="keyword">delete</span> <a class="code" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>;
<a name="l00100"></a>00100         <span class="keyword">delete</span> fm::graphstate;
<a name="l00101"></a>00101         <span class="keyword">delete</span> fm::closelegoccurrences;
<a name="l00102"></a>00102         <span class="keyword">delete</span> fm::legoccurrences;
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104     fm::database = <span class="keyword">new</span> Database();
<a name="l00105"></a>00105     fm::statistics = <span class="keyword">new</span> Statistics();
<a name="l00106"></a>00106     <a class="code" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a> = <span class="keyword">new</span> ChisqConstraint(3.84146);
<a name="l00107"></a>00107     fm::graphstate = <span class="keyword">new</span> GraphState();
<a name="l00108"></a>00108     fm::closelegoccurrences = <span class="keyword">new</span> CloseLegOccurrences();
<a name="l00109"></a>00109     fm::legoccurrences = <span class="keyword">new</span> LegOccurrences();
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     fm::candidatecloselegsoccsused.clear();
<a name="l00112"></a>00112 
<a name="l00113"></a>00113     <a class="code" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>-&gt;active=<span class="keyword">true</span>; 
<a name="l00114"></a>00114     fm::result = &amp;r;
<a name="l00115"></a>00115     comp_runner=0; 
<a name="l00116"></a>00116     comp_no=0; 
<a name="l00117"></a>00117     init_mining_done = <span class="keyword">false</span>;
<a name="l00118"></a>00118 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9f4ebfcbb62fb16b57c5bcdfaacd451f"></a><!-- doxytag: member="Last::Defaults" ref="9f4ebfcbb62fb16b57c5bcdfaacd451f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Defaults           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Use this to set default parameters as in default constructor. 
<p>

<p>References <a class="el" href="namespacefm.html#5b3dab8ff08516a4daa7bb804b6dd368">fm::aromatic</a>, <a class="el" href="namespacefm.html#a0ba1526464d76d5791dedd050c1fc18">fm::bbrc_sep</a>, <a class="el" href="namespacefm.html#e3778362791642453eccdf44001942c4">fm::do_pruning</a>, and <a class="el" href="namespacefm.html#b121ac08f2cdaf32be0af36a5ae79755">fm::gsp_out</a>.</p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00028">Last()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00120"></a>00120                     {
<a name="l00121"></a>00121     fm::minfreq = 2;
<a name="l00122"></a>00122     fm::type = 2;
<a name="l00123"></a>00123     <a class="code" href="namespacefm.html#e3778362791642453eccdf44001942c4">fm::do_pruning</a> = <span class="keyword">true</span>;
<a name="l00124"></a>00124     fm::console_out = <span class="keyword">true</span>;
<a name="l00125"></a>00125     <a class="code" href="namespacefm.html#5b3dab8ff08516a4daa7bb804b6dd368">fm::aromatic</a> = <span class="keyword">true</span>;
<a name="l00126"></a>00126     fm::refine_singles = <span class="keyword">false</span>;
<a name="l00127"></a>00127     fm::do_output=<span class="keyword">true</span>;
<a name="l00128"></a>00128     <a class="code" href="namespacefm.html#a0ba1526464d76d5791dedd050c1fc18">fm::bbrc_sep</a>=<span class="keyword">false</span>;
<a name="l00129"></a>00129     fm::updated = <span class="keyword">true</span>;
<a name="l00130"></a>00130     <a class="code" href="namespacefm.html#b121ac08f2cdaf32be0af36a5ae79755">fm::gsp_out</a>=<span class="keyword">true</span>;
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="comment">// LAST</span>
<a name="l00133"></a>00133     fm::do_last=<span class="keyword">true</span>;
<a name="l00134"></a>00134     fm::last_hops=0;
<a name="l00135"></a>00135     fm::die = 0;
<a name="l00136"></a>00136 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6b73a9fcdd27d073f4ba6686c9cca02f"></a><!-- doxytag: member="Last::GetMinfreq" ref="6b73a9fcdd27d073f4ba6686c9cca02f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GetMinfreq           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get minimum frequency. 
<p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00219">MineRoot()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00141"></a>00141 {<span class="keywordflow">return</span> fm::minfreq;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="00c83761de7dca2e16d741650b41f1ef"></a><!-- doxytag: member="Last::GetType" ref="00c83761de7dca2e16d741650b41f1ef" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GetType           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get type. 
<p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00219">MineRoot()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00142"></a>00142 {<span class="keywordflow">return</span> fm::type;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4dd6282e6926b0e7a926036127042030"></a><!-- doxytag: member="Last::GetBackbone" ref="4dd6282e6926b0e7a926036127042030" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetBackbone           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get whether BBRC representatives should be mined. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00143"></a>00143 {<span class="keywordflow">return</span> <span class="keyword">false</span>;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b0cbbc3a50704734e46986234dbc68ce"></a><!-- doxytag: member="Last::GetDynamicUpperBound" ref="b0cbbc3a50704734e46986234dbc68ce" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetDynamicUpperBound           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get whether dynamic upper bound pruning is used. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00144"></a>00144 {<span class="keywordflow">return</span> <span class="keyword">false</span>;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e89056d89e3847cce0172baea6a37b26"></a><!-- doxytag: member="Last::GetPruning" ref="e89056d89e3847cce0172baea6a37b26" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetPruning           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get whether statistical metric pruning should be used. 
<p>

<p>References <a class="el" href="namespacefm.html#e3778362791642453eccdf44001942c4">fm::do_pruning</a>.</p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00219">MineRoot()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00145"></a>00145 {<span class="keywordflow">return</span> <a class="code" href="namespacefm.html#e3778362791642453eccdf44001942c4">fm::do_pruning</a>;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="91c37ee435171e92c4efe49e084d6130"></a><!-- doxytag: member="Last::GetConsoleOut" ref="91c37ee435171e92c4efe49e084d6130" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetConsoleOut           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get whether output should be directed to the console. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00146"></a>00146 {<span class="keywordflow">return</span> fm::console_out;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8c5138a564797432427b6667dd2976b3"></a><!-- doxytag: member="Last::GetAromatic" ref="8c5138a564797432427b6667dd2976b3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetAromatic           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get whether aromatic rings should be perceived instead of Kekule notation. 
<p>

<p>References <a class="el" href="namespacefm.html#5b3dab8ff08516a4daa7bb804b6dd368">fm::aromatic</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00147"></a>00147 {<span class="keywordflow">return</span> <a class="code" href="namespacefm.html#5b3dab8ff08516a4daa7bb804b6dd368">fm::aromatic</a>;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="43b57f5108e2a25ae8b08ab91179dfb5"></a><!-- doxytag: member="Last::GetRefineSingles" ref="43b57f5108e2a25ae8b08ab91179dfb5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetRefineSingles           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get whether fragments with frequency 1 should be refined. 
<p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00159">SetMinfreq()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00148"></a>00148 {<span class="keywordflow">return</span> fm::refine_singles;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="854663daf425c444db86d80cc862ba9c"></a><!-- doxytag: member="Last::GetDoOutput" ref="854663daf425c444db86d80cc862ba9c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetDoOutput           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get whether output is enabled. 
<p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00219">MineRoot()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00149"></a>00149 {<span class="keywordflow">return</span> fm::do_output;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="84f3001cb532d71e4edce28fc0f83ec2"></a><!-- doxytag: member="Last::GetBbrcSep" ref="84f3001cb532d71e4edce28fc0f83ec2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetBbrcSep           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get whether BBRCs should be separated in the output. 
<p>

<p>References <a class="el" href="namespacefm.html#a0ba1526464d76d5791dedd050c1fc18">fm::bbrc_sep</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00150"></a>00150 {<span class="keywordflow">return</span> <a class="code" href="namespacefm.html#a0ba1526464d76d5791dedd050c1fc18">fm::bbrc_sep</a>;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f23472dda234c80fdc244494cd4f09cc"></a><!-- doxytag: member="Last::GetChisqActive" ref="f23472dda234c80fdc244494cd4f09cc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetChisqActive           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get whether chi-square filter is active. 
<p>

<p>References <a class="el" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>.</p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00219">MineRoot()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00151"></a>00151 {<span class="keywordflow">return</span> <a class="code" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>-&gt;active;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5b719d86b406c885f898ea332ec8deaf"></a><!-- doxytag: member="Last::GetChisqSig" ref="5b719d86b406c885f898ea332ec8deaf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float GetChisqSig           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get significance threshold. 
<p>

<p>References <a class="el" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>.</p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00219">MineRoot()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00152"></a>00152 {<span class="keywordflow">return</span> <a class="code" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>-&gt;sig;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8471ab39593e52b542e9284a12517f4c"></a><!-- doxytag: member="Last::GetRegression" ref="8471ab39593e52b542e9284a12517f4c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetRegression           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Dummy method for regression (only used for bbrcs). 
<p>
<div class="fragment"><pre class="fragment"><a name="l00153"></a>00153 {<span class="keywordflow">return</span> <span class="keyword">false</span>;}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1943edc900a48af0fc9498f5d0579d80"></a><!-- doxytag: member="Last::SetMinfreq" ref="1943edc900a48af0fc9498f5d0579d80" args="(int val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetMinfreq           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set minimum frequency (&gt;=1 here). 
<p>

<p>References <a class="el" href="last_8cpp-source.html#l00148">GetRefineSingles()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00159"></a>00159                              {
<a name="l00160"></a>00160     <span class="keywordflow">if</span> (val &lt; 1) { cerr &lt;&lt; <span class="stringliteral">"Error! Invalid value '"</span> &lt;&lt; val &lt;&lt; <span class="stringliteral">"' for parameter minfreq."</span> &lt;&lt; endl; exit(1); }
<a name="l00161"></a>00161     <span class="keywordflow">if</span> (val &gt; 1 &amp;&amp; <a class="code" href="classLast.html#43b57f5108e2a25ae8b08ab91179dfb5" title="Get whether fragments with frequency 1 should be refined.">GetRefineSingles</a>()) { cerr &lt;&lt; <span class="stringliteral">"Warning! Minimum frequency of '"</span> &lt;&lt; val &lt;&lt; <span class="stringliteral">"' could not be set due to activated single refinement."</span> &lt;&lt; endl;}
<a name="l00162"></a>00162     fm::minfreq = val;
<a name="l00163"></a>00163 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="bc2a46f77095216632a268a9417f1174"></a><!-- doxytag: member="Last::SetType" ref="bc2a46f77095216632a268a9417f1174" args="(int val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetType           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set type 1 (paths) or 2 (trees) here. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00167"></a>00167                           {
<a name="l00168"></a>00168     <span class="keywordflow">return</span> 0;
<a name="l00169"></a>00169 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7a001c8c0f5014435e1a28ba57a5d5f2"></a><!-- doxytag: member="Last::SetBackbone" ref="7a001c8c0f5014435e1a28ba57a5d5f2" args="(bool val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBackbone           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pass 'false' here to switch off mining for BBRC representatives. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00171"></a>00171                                {
<a name="l00172"></a>00172     <span class="keywordflow">return</span> 0;
<a name="l00173"></a>00173 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="273df5b815f6f9318aa65db134283b0e"></a><!-- doxytag: member="Last::SetDynamicUpperBound" ref="273df5b815f6f9318aa65db134283b0e" args="(bool val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetDynamicUpperBound           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pass 'false' here to disable dynamic upper bound pruning (e.g. for performance measures). 
<p>
<div class="fragment"><pre class="fragment"><a name="l00175"></a>00175                                         {
<a name="l00176"></a>00176     <span class="keywordflow">return</span> 0;
<a name="l00177"></a>00177 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3eef7a8547f2a4940fd0f4b7d1b70861"></a><!-- doxytag: member="Last::SetPruning" ref="3eef7a8547f2a4940fd0f4b7d1b70861" args="(bool val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetPruning           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pass 'false' here to disable statistical metrical pruning completely. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00179"></a>00179                               {
<a name="l00180"></a>00180     <span class="keywordflow">return</span> 0;
<a name="l00181"></a>00181 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3dfd23b477755e3b2156185b2f73878b"></a><!-- doxytag: member="Last::SetConsoleOut" ref="3dfd23b477755e3b2156185b2f73878b" args="(bool val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetConsoleOut           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pass 'true' here to disable usage of result vector and directly print each fragment to the console (saves memory). 
<p>
<div class="fragment"><pre class="fragment"><a name="l00183"></a>00183                                  {
<a name="l00184"></a>00184     <span class="keywordflow">return</span> 0;
<a name="l00185"></a>00185 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b5195d37511301667fcc1a341f0888bf"></a><!-- doxytag: member="Last::SetAromatic" ref="b5195d37511301667fcc1a341f0888bf" args="(bool val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetAromatic           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pass 'true' here to enable aromatic rings and use Kekule notation. 
<p>

<p>References <a class="el" href="namespacefm.html#5b3dab8ff08516a4daa7bb804b6dd368">fm::aromatic</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00187"></a>00187                                {
<a name="l00188"></a>00188     <a class="code" href="namespacefm.html#5b3dab8ff08516a4daa7bb804b6dd368">fm::aromatic</a> = val;
<a name="l00189"></a>00189 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="799653965569b70a7dd88ef16d56f569"></a><!-- doxytag: member="Last::SetRefineSingles" ref="799653965569b70a7dd88ef16d56f569" args="(bool val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetRefineSingles           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pass 'true' here to enable refinement of fragments with frequency 1. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00191"></a>00191                                     {
<a name="l00192"></a>00192     <span class="keywordflow">return</span> 0;
<a name="l00193"></a>00193 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5ba23af2c3f5f549da20c6def6e0c554"></a><!-- doxytag: member="Last::SetDoOutput" ref="5ba23af2c3f5f549da20c6def6e0c554" args="(bool val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetDoOutput           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pass 'false' here to disable output. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00195"></a>00195                                {
<a name="l00196"></a>00196     fm::do_output = val;
<a name="l00197"></a>00197 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c569ce6ce6150f0efc5ac9e13293b517"></a><!-- doxytag: member="Last::SetBbrcSep" ref="c569ce6ce6150f0efc5ac9e13293b517" args="(bool val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBbrcSep           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set this to 'true' to enable BBRC separators in output. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00199"></a>00199                               {
<a name="l00200"></a>00200     <span class="keywordflow">return</span> 0;
<a name="l00201"></a>00201 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3040636e6d4456e59fa925ddad8d4eb4"></a><!-- doxytag: member="Last::SetChisqActive" ref="3040636e6d4456e59fa925ddad8d4eb4" args="(bool val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetChisqActive           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set this to 'true' to enable chi-square filter. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00203"></a>00203                                   {
<a name="l00204"></a>00204     <span class="keywordflow">return</span> 0;
<a name="l00205"></a>00205 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2ffe9fadf7a96e7d3f83cbd977004278"></a><!-- doxytag: member="Last::SetChisqSig" ref="2ffe9fadf7a96e7d3f83cbd977004278" args="(float _chisq_val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetChisqSig           </td>
          <td>(</td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>_chisq_val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set significance threshold here (between 0 and 1). 
<p>
<div class="fragment"><pre class="fragment"><a name="l00207"></a>00207                                        {
<a name="l00208"></a>00208     <span class="keywordflow">return</span> 0;
<a name="l00209"></a>00209 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7b8900193deba5c64f10fe35d8bc5875"></a><!-- doxytag: member="Last::SetRegression" ref="7b8900193deba5c64f10fe35d8bc5875" args="(bool val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetRegression           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>val</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Dummy method for regression (only used for bbrcs). 
<p>
<div class="fragment"><pre class="fragment"><a name="l00211"></a>00211                                  {
<a name="l00212"></a>00212     <span class="keywordflow">return</span> 0;
<a name="l00213"></a>00213     <span class="comment">// TODO: enable regression</span>
<a name="l00214"></a>00214 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ca859309dfdec16d1fe7bbca9a31910a"></a><!-- doxytag: member="Last::MineRoot" ref="ca859309dfdec16d1fe7bbca9a31910a" args="(unsigned int j)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; string &gt; * MineRoot           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>j</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mine fragments rooted at the j-th root node (element type). 
<p>

<p>References <a class="el" href="namespacefm.html#a0ba1526464d76d5791dedd050c1fc18">fm::bbrc_sep</a>, <a class="el" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>, <a class="el" href="last_8cpp-source.html#l00151">GetChisqActive()</a>, <a class="el" href="last_8cpp-source.html#l00152">GetChisqSig()</a>, <a class="el" href="last_8cpp-source.html#l00149">GetDoOutput()</a>, <a class="el" href="last_8cpp-source.html#l00141">GetMinfreq()</a>, <a class="el" href="last_8h-source.html#l00105">GetNoRootNodes()</a>, <a class="el" href="last_8cpp-source.html#l00145">GetPruning()</a>, and <a class="el" href="last_8cpp-source.html#l00142">GetType()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00219"></a>00219                                              {
<a name="l00220"></a>00220     fm::result-&gt;clear();
<a name="l00221"></a>00221     <span class="keywordflow">if</span> (!init_mining_done) {
<a name="l00222"></a>00222         <span class="keywordflow">if</span> (<a class="code" href="namespacefm.html#69498865fc6c644fcf39babbeb314794">fm::chisq</a>-&gt;active) {
<a name="l00223"></a>00223             each (fm::database-&gt;trees) {
<a name="l00224"></a>00224                 <span class="keywordflow">if</span> (fm::database-&gt;trees[i]-&gt;activity == -1) {
<a name="l00225"></a>00225                     cerr &lt;&lt; <span class="stringliteral">"Error! ID "</span> &lt;&lt; fm::database-&gt;trees[i]-&gt;orig_tid &lt;&lt; <span class="stringliteral">" is missing activity information."</span> &lt;&lt; endl;
<a name="l00226"></a>00226                     exit(1);
<a name="l00227"></a>00227                 }
<a name="l00228"></a>00228             }
<a name="l00229"></a>00229         }
<a name="l00230"></a>00230         fm::database-&gt;edgecount (); 
<a name="l00231"></a>00231         fm::database-&gt;reorder (); 
<a name="l00232"></a>00232         initLegStatics (); 
<a name="l00233"></a>00233         fm::graphstate-&gt;init (); 
<a name="l00234"></a>00234         <span class="keywordflow">if</span> (<a class="code" href="namespacefm.html#a0ba1526464d76d5791dedd050c1fc18">fm::bbrc_sep</a> &amp;&amp; fm::do_output &amp;&amp; !fm::console_out) (*fm::result) &lt;&lt; fm::graphstate-&gt;sep();
<a name="l00235"></a>00235         init_mining_done=<span class="keyword">true</span>; 
<a name="l00236"></a>00236 
<a name="l00237"></a>00237         cerr &lt;&lt; <span class="stringliteral">"Settings:"</span> &lt;&lt; endl \
<a name="l00238"></a>00238              &lt;&lt; <span class="stringliteral">"---"</span> &lt;&lt; endl \
<a name="l00239"></a>00239              &lt;&lt; <span class="stringliteral">"Type:                                 "</span> &lt;&lt; <a class="code" href="classLast.html#00c83761de7dca2e16d741650b41f1ef" title="Get type.">GetType</a>() &lt;&lt; endl \
<a name="l00240"></a>00240              &lt;&lt; <span class="stringliteral">"Minimum frequency:                    "</span> &lt;&lt; <a class="code" href="classLast.html#6b73a9fcdd27d073f4ba6686c9cca02f" title="Get minimum frequency.">GetMinfreq</a>() &lt;&lt; endl \
<a name="l00241"></a>00241              &lt;&lt; <span class="stringliteral">"Chi-square active (chi-square-value): "</span> &lt;&lt; <a class="code" href="classLast.html#f23472dda234c80fdc244494cd4f09cc" title="Get whether chi-square filter is active.">GetChisqActive</a>() &lt;&lt; <span class="stringliteral">" ("</span> &lt;&lt; <a class="code" href="classLast.html#5b719d86b406c885f898ea332ec8deaf" title="Get significance threshold.">GetChisqSig</a>()&lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl \
<a name="l00242"></a>00242              &lt;&lt; <span class="stringliteral">"Statistical metric pruning:           "</span> &lt;&lt; <a class="code" href="classLast.html#e89056d89e3847cce0172baea6a37b26" title="Get whether statistical metric pruning should be used.">GetPruning</a>() &lt;&lt; endl \
<a name="l00243"></a>00243              &lt;&lt; <span class="stringliteral">"Do output:                            "</span> &lt;&lt; <a class="code" href="classLast.html#854663daf425c444db86d80cc862ba9c" title="Get whether output is enabled.">GetDoOutput</a>() &lt;&lt; endl \
<a name="l00244"></a>00244              &lt;&lt; <span class="stringliteral">"---"</span> &lt;&lt; endl;
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 
<a name="l00247"></a>00247         <span class="keywordflow">if</span> (fm::do_output) {
<a name="l00248"></a>00248             cout &lt;&lt; <span class="stringliteral">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;"</span> &lt;&lt; endl;
<a name="l00249"></a>00249             cout &lt;&lt; <span class="stringliteral">"&lt;graphml xmlns=\"http://graphml.graphdrawing.org/xmlns\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:noNamespaceSchemaLocation=\"graphml.xsd\"&gt;"</span> &lt;&lt; endl &lt;&lt; endl;
<a name="l00250"></a>00250 
<a name="l00251"></a>00251             cout &lt;&lt; <span class="stringliteral">"&lt;!-- LAtent STructure Mining (LAST) descriptors--&gt;"</span> &lt;&lt; endl &lt;&lt; endl;
<a name="l00252"></a>00252             cout &lt;&lt; <span class="stringliteral">"&lt;key id=\"act\" for=\"graph\" attr.name=\"activating\" attr.type=\"boolean\" /&gt;"</span> &lt;&lt; endl;
<a name="l00253"></a>00253             cout &lt;&lt; <span class="stringliteral">"&lt;key id=\"hops\" for=\"graph\" attr.name=\"hops\" attr.type=\"int\" /&gt;"</span> &lt;&lt; endl;
<a name="l00254"></a>00254             cout &lt;&lt; <span class="stringliteral">"&lt;key id=\"lab_n\" for=\"node\" attr.name=\"node_labels\" attr.type=\"string\" /&gt;"</span> &lt;&lt; endl;
<a name="l00255"></a>00255             cout &lt;&lt; <span class="stringliteral">"&lt;key id=\"lab_e\" for=\"edge\" attr.name=\"edge_labels\" attr.type=\"string\" /&gt;"</span> &lt;&lt; endl;
<a name="l00256"></a>00256             cout &lt;&lt; <span class="stringliteral">"&lt;key id=\"weight\" for=\"edge\" attr.name=\"edge_weight\" attr.type=\"int\" /&gt;"</span> &lt;&lt; endl;
<a name="l00257"></a>00257             cout &lt;&lt; <span class="stringliteral">"&lt;key id=\"del\" for=\"edge\" attr.name=\"edge_deleted\" attr.type=\"boolean\" /&gt;"</span> &lt;&lt; endl;
<a name="l00258"></a>00258         }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260     }
<a name="l00261"></a>00261     <span class="keywordflow">if</span> (j &gt;= fm::database-&gt;nodelabels.size()) { cerr &lt;&lt; <span class="stringliteral">"Error! Root node "</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">" does not exist."</span> &lt;&lt; endl;  exit(1); }
<a name="l00262"></a>00262     <span class="keywordflow">if</span> ( fm::database-&gt;nodelabels[j].frequency &gt;= fm::minfreq &amp;&amp; fm::database-&gt;nodelabels[j].frequentedgelabels.size () ) {
<a name="l00263"></a>00263         Path path(j);
<a name="l00264"></a>00264         path.expand(); <span class="comment">// mining step</span>
<a name="l00265"></a>00265     }
<a name="l00266"></a>00266     <span class="keywordflow">if</span> (j==<a class="code" href="classLast.html#bc7291463c89c905f4371f3d9ba12f47" title="Get number of root nodes (different element types).">GetNoRootNodes</a>()-1 &amp;&amp; fm::do_output) cout &lt;&lt; <span class="stringliteral">"&lt;/graphml&gt;"</span> &lt;&lt; endl;
<a name="l00267"></a>00267     <span class="keywordflow">return</span> fm::result;
<a name="l00268"></a>00268 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f877482dbaf9aa27fbe9524479758c9c"></a><!-- doxytag: member="Last::ReadGsp" ref="f877482dbaf9aa27fbe9524479758c9c" args="(FILE *gsp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReadGsp           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>gsp</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read in a gSpan file. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00270"></a>00270                            {
<a name="l00271"></a>00271     fm::database-&gt;readGsp(gsp);
<a name="l00272"></a>00272 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7ae3274987947421c41022918f48378d"></a><!-- doxytag: member="Last::AddCompound" ref="7ae3274987947421c41022918f48378d" args="(string smiles, unsigned int comp_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool AddCompound           </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>smiles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>comp_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a compound to the database. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00274"></a>00274                                                           {
<a name="l00275"></a>00275     <span class="keywordtype">bool</span> insert_done=<span class="keyword">false</span>;
<a name="l00276"></a>00276     <span class="keywordflow">if</span> (comp_id&lt;=0) { cerr &lt;&lt; <span class="stringliteral">"Error! IDs must be of type: Int &gt; 0."</span> &lt;&lt; endl;}
<a name="l00277"></a>00277     <span class="keywordflow">else</span> {
<a name="l00278"></a>00278         <span class="keywordflow">if</span> (fm::database-&gt;readTreeSmi (smiles, comp_no, comp_id, comp_runner)) {
<a name="l00279"></a>00279             insert_done=<span class="keyword">true</span>;
<a name="l00280"></a>00280             comp_no++;
<a name="l00281"></a>00281         }
<a name="l00282"></a>00282         <span class="keywordflow">else</span> { cerr &lt;&lt; <span class="stringliteral">"Error on compound "</span> &lt;&lt; comp_runner &lt;&lt; <span class="stringliteral">", id "</span> &lt;&lt; comp_id &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; endl; }
<a name="l00283"></a>00283         comp_runner++;
<a name="l00284"></a>00284     }
<a name="l00285"></a>00285     <span class="keywordflow">return</span> insert_done;
<a name="l00286"></a>00286 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="864483449b0171b7e7c33851471c9087"></a><!-- doxytag: member="Last::AddActivity" ref="864483449b0171b7e7c33851471c9087" args="(float act, unsigned int comp_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool AddActivity           </td>
          <td>(</td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>act</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>comp_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add an activity to the database. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00301"></a>00301                                                       {
<a name="l00302"></a>00302     
<a name="l00303"></a>00303     <span class="keywordflow">if</span> (fm::database-&gt;trees_map[comp_id] == NULL) { 
<a name="l00304"></a>00304         cerr &lt;&lt; <span class="stringliteral">"No structure for ID "</span> &lt;&lt; comp_id &lt;&lt; <span class="stringliteral">". Ignoring entry!"</span> &lt;&lt; endl; <span class="keywordflow">return</span> <span class="keyword">false</span>; 
<a name="l00305"></a>00305     }
<a name="l00306"></a>00306     <span class="keywordflow">else</span> {
<a name="l00307"></a>00307         <span class="keywordtype">bool</span> act_b=<span class="keyword">false</span>; 
<a name="l00308"></a>00308         <span class="keywordflow">if</span> (act == 1.0) act_b=<span class="keyword">true</span>; 
<a name="l00309"></a>00309         <span class="keywordflow">else</span> { <span class="keywordflow">if</span> (act!=0.0) { cerr &lt;&lt; <span class="stringliteral">"Error! Unknown activity "</span> &lt;&lt; act &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; endl; exit(1); } }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311         <span class="keywordflow">if</span> ((fm::database-&gt;trees_map[comp_id]-&gt;activity = act_b)) AddChiSqNa();
<a name="l00312"></a>00312         <span class="keywordflow">else</span> AddChiSqNi();
<a name="l00313"></a>00313 
<a name="l00314"></a>00314         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00315"></a>00315     }
<a name="l00316"></a>00316 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="bc7291463c89c905f4371f3d9ba12f47"></a><!-- doxytag: member="Last::GetNoRootNodes" ref="bc7291463c89c905f4371f3d9ba12f47" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GetNoRootNodes           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get number of root nodes (different element types). 
<p>

<p>Referenced by <a class="el" href="last_8cpp-source.html#l00219">MineRoot()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9b74deeffd380f1269c906f4178a8ab0"></a><!-- doxytag: member="Last::GetNoCompounds" ref="9b74deeffd380f1269c906f4178a8ab0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GetNoCompounds           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get number of compounds in the database. 
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="last_8h-source.html">last.h</a><li><a class="el" href="last_8cpp.html">last.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Mar 3 15:47:32 2010 for liblast by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
